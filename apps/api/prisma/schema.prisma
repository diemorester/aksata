// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id                    Int         @id @default(autoincrement())
  name                  String      @unique
  email                 String      @unique
  password              String
  avatar                String?
  phone                 String?     @unique
  isVerified            Boolean     @default(false)
  role                  Roles
  otp                   String?
  otpExpired            DateTime?
  changeEmailExpired    DateTime?
  changePasswordExpired DateTime?
  refreshToken          String?     @db.Text
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt()
  Absensi               Absensi[]
  Pengajuan             Pengajuan[]
}

enum Roles {
  User
  SuperAdmin
  AdminHR
  AdminGudang
}

model Absensi {
  id         String      @id @default(cuid())
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt()
  clockIn    DateTime?
  clockOut   DateTime?
  duration   String?
  location   String?
  status     Status?
  date       DateTime    @default(now())
  user       User        @relation(fields: [userId], references: [id])
  userId     Int
  keterangan String?
  Pengajuan  Pengajuan[]
}

enum Status {
  Hadir
  Sakit
  Cuti
  Izin
  Alpha
}

model Pengajuan {
  id         String          @id @default(cuid())
  nominal    Float?
  tipeLembur OpsiLembur?
  status     StatusPengajuan @default(Waiting)
  user       User            @relation(fields: [userId], references: [id])
  userId     Int
  createdAt  DateTime        @default(now())
  updatedAt  DateTime        @updatedAt
  startDate  DateTime?
  endDate    DateTime?
  absensi    Absensi         @relation(fields: [absensiId], references: [id])
  absensiId  String
}

enum StatusPengajuan {
  Approved
  Waiting
  Cancelled
  Declined
}

enum Companies {
  Ristoan
  Hayan
  Sirius
}

enum OpsiLembur {
  LemburSatu
  LemburDua
  LemburTiga
}

model Gudang {
  id String @id @default(cuid())
}
